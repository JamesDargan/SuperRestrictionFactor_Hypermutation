2019-11-20 10:45:09,472 - INFO - Beginning execution of dms2_bcsubamp in directory /fh/fast/bloom_j/computational_notebooks/kdusenbu/2019/SuperRFs/SuperRestrictionFactor_Hypermutation

2019-11-20 10:45:09,472 - INFO - Progress is being logged to ./results_1and1b/codoncounts/COTDE254A-2.log
2019-11-20 10:45:09,482 - INFO - Version information:
	Time and date: Wed Nov 20 10:45:09 2019
	Platform: Linux-3.13.0-143-generic-x86_64-with-debian-jessie-sid
	Python version: 3.6.7 | packaged by conda-forge | (default, Jul  2 2019, 02:18:42)  [GCC 7.3.0]
	dms_tools2 version: 2.6.4
	Bio version: 1.74
	pandas version: 0.25.1
	numpy version: 1.17.2
	IPython version: 7.8.0
	jupyter version unknown
	matplotlib version: 3.1.1
	plotnine version: 0.6.0
	natsort version: 6.0.0
	pystan version: 2.19.0.0
	scipy version: 1.3.1
	seaborn version: 0.9.0
	phydmslib version: 2.3.4
	statsmodels version: 0.10.1
	rpy2 version: 3.1.0
	regex version: 2.5.64
	umi_tools version: 1.0.0

2019-11-20 10:45:09,483 - INFO - Parsed the following arguments:
	outdir = ./results_1and1b/codoncounts
	ncpus = -1
	use_existing = no
	refseq = ./data/Bru_Pol.fasta
	alignspecs = ['205,504,35,34']
	bclen = 8
	fastqdir = ../../../../adingens/2019/SuperRes_Hypermut/FASTQ_files
	R2 = None
	R1trim = [200]
	R2trim = [170]
	bclen2 = None
	chartype = codon
	maxmuts = 30
	minq = 15
	minreads = 2
	minfraccall = 0.95
	minconcur = 0.75
	sitemask = ./data/sitemask.csv
	purgeread = 0
	purgebc = 0
	bcinfo = True
	bcinfo_csv = True
	name = COTDE254A-2
	R1 = ['COTDE254A-2_R1.fastq.gz']

2019-11-20 10:45:09,485 - INFO - Removing existing file ./results_1and1b/codoncounts/COTDE254A-2_codoncounts.csv
2019-11-20 10:45:09,492 - INFO - Removing existing file ./results_1and1b/codoncounts/COTDE254A-2_readstats.csv
2019-11-20 10:45:09,501 - INFO - Removing existing file ./results_1and1b/codoncounts/COTDE254A-2_readsperbc.csv
2019-11-20 10:45:09,508 - INFO - Removing existing file ./results_1and1b/codoncounts/COTDE254A-2_bcstats.csv
2019-11-20 10:45:09,514 - INFO - Removing existing file ./results_1and1b/codoncounts/COTDE254A-2_bcinfo.csv.gz
2019-11-20 10:45:09,539 - INFO - Read refseq of 3048 codons from ./data/Bru_Pol.fasta
2019-11-20 10:45:09,540 - INFO - Reads are in these FASTQ pairs:
	../../../../adingens/2019/SuperRes_Hypermut/FASTQ_files/COTDE254A-2_R1.fastq.gz and ../../../../adingens/2019/SuperRes_Hypermut/FASTQ_files/COTDE254A-2_R2.fastq.gz

2019-11-20 10:45:09,540 - INFO - Now parsing read pairs...
2019-11-20 10:45:16,478 - INFO - Reads parsed so far: 500000
2019-11-20 10:45:24,187 - INFO - Reads parsed so far: 1000000
2019-11-20 10:45:30,213 - INFO - Reads parsed so far: 1500000
2019-11-20 10:45:30,852 - INFO - Parsed 1553050 reads, found 261059 unique barcodes.
2019-11-20 10:45:30,858 - INFO - Summary stats on reads:
   total  fail filter  low Q barcode
 1553050            0          90792
2019-11-20 10:45:30,858 - INFO - Writing these stats to ./results_1and1b/codoncounts/COTDE254A-2_readstats.csv

2019-11-20 10:45:30,950 - INFO - Number of reads per barcode:
                 number of barcodes
number of reads                    
1                             66902
2                              6592
3                             10917
4                             16968
5                             22859
6                             26733
7                             26992
8                             24390
9                             19798
10                            14933
11                             9900
12                             6136
13                             3708
14                             1982
15                             1039
16                              537
17                              275
18                              159
19                              104
20                               48
21                               31
22                               15
23                               13
24                               11
25                                5
26                                5
27                                2
28                                1
29                                1
30                                1
31                                1
175                               1
2019-11-20 10:45:30,950 - INFO - Writing these stats to ./results_1and1b/codoncounts/COTDE254A-2_readsperbc.csv

2019-11-20 10:45:30,954 - INFO - Examining the 261059 barcodes to build and align subamplicons...
2019-11-20 10:45:46,879 - INFO - Barcodes examined so far: 200000
2019-11-20 10:45:49,302 - INFO - Examined all barcodes. Summary stats:
  total  too few reads  not alignable  aligned
 261059          66902           5964   188193
2019-11-20 10:45:49,303 - INFO - Writing these stats to ./results_1and1b/codoncounts/COTDE254A-2_bcstats.csv

2019-11-20 10:45:49,331 - INFO - Filtering to only sites listed in sitemask ./data/sitemask.csv
2019-11-20 10:45:49,344 - INFO - Filtered from 1016 to 101 sites.
2019-11-20 10:45:49,344 - INFO - Writing the counts of each codon identity at each site to ./results_1and1b/codoncounts/COTDE254A-2_codoncounts.csv

2019-11-20 10:45:49,355 - INFO - Successful completion of dms2_bcsubamp
